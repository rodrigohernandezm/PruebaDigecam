<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Prueba DIGECAM</title>
  <style>
    body { font-family: Arial, sans-serif; text-align: center; margin: 0; padding: 0; }
    .container { max-width: 600px; margin: auto; padding: 20px; }
    .ad { width: 100%; height: 100px; margin: 10px auto; background: #ddd; text-align: center; line-height: 100px; }
    .question { margin-bottom: 20px; text-align: left; }
    .result { font-size: 1.2em; margin-top: 20px; }
    button { padding: 10px 20px; margin-top: 20px; }
    .correct-answer { color: green; }
    .wrong-answer { color: red; }
    img { max-width: 100%; height: auto; margin: 10px 0; }
  </style>
</head>
<body>
  <div class="ad">Publicidad</div>
  <div class="container">
    <h1>Prueba de la DIGECAM</h1>
    <img id="quiz-image" src="" alt="Imagen del examen">
    <form id="quiz-form"></form>
    <button id="submit">Calificar</button>
    <div id="results" class="result"></div>
    <button id="restart" style="display: none;">Reiniciar</button>
  </div>
  <div class="ad">Publicidad</div>

  <script>
const imageQuestionBank = [
  {
    image: "https://github.com/usuario/repositorio/arma1.jpg",
    questions: [
      {
        question: "¿Qué tipo de arma es esta?",
        options: ["Pistola", "Rifle", "Escopeta"],
        answer: 0
      },
      {
        question: "¿Cuál es el uso principal de esta arma?",
        options: ["Defensa personal", "Caza", "Uso militar"],
        answer: 1
      }
    ]
  },
  {
    image: "https://github.com/usuario/repositorio/arma2.jpg",
    questions: [
      {
        question: "¿Qué parte del arma se muestra?",
        options: ["Cañón", "Culata", "Disparador"],
        answer: 2
      },
      {
        question: "¿En qué contexto se usa esta parte del arma?",
        options: ["Limpieza", "Disparo", "Montaje"],
        answer: 1
      }
    ]
  },
  {
    image: "https://github.com/usuario/repositorio/imagen3.jpg",
    questions: [
      {
        question: "¿Qué calibre es esta arma?",
        options: ["9mm", "7.62mm", "5.56mm"],
        answer: 0
      },
      {
        question: "¿Qué tipo de munición usa?",
        options: ["Cartuchos", "Balas de plomo", "Balas de goma"],
        answer: 1
      }
    ]
  }
];

const staticImage = "https://via.placeholder.com/600x200.png?text=Publicidad";
const quizForm = document.getElementById("quiz-form");
const submitButton = document.getElementById("submit");
const resultsDiv = document.getElementById("results");
const restartButton = document.getElementById("restart");
const quizImage = document.getElementById("quiz-image");

function shuffle(array) {
  return array.sort(() => Math.random() - 0.5);
}

function loadQuiz() {
  quizForm.innerHTML = "";
  resultsDiv.innerHTML = "";
  submitButton.style.display = "inline";
  restartButton.style.display = "none";

  // Selección aleatoria de una imagen y sus preguntas
  const randomImageQuestion = imageQuestionBank[Math.floor(Math.random() * imageQuestionBank.length)];
  quizImage.src = randomImageQuestion.image;

  // Cargar preguntas para la imagen seleccionada
  randomImageQuestion.questions.forEach((q, index) => {
    const questionElement = document.createElement("div");
    questionElement.classList.add("question");

    const questionText = `<p>${index + 1}. ${q.question}</p>`;
    const dropdown = document.createElement("select");
    dropdown.name = `image-question-${index}`;

    const defaultOption = document.createElement("option");
    defaultOption.value = "";
    defaultOption.textContent = "Seleccione una respuesta";
    defaultOption.disabled = true;
    defaultOption.selected = true;
    dropdown.appendChild(defaultOption);

    q.options.forEach((opt, i) => {
      const option = document.createElement("option");
      option.value = i;
      option.textContent = opt;
      dropdown.appendChild(option);
    });

    questionElement.innerHTML = questionText;
    questionElement.appendChild(dropdown);
    quizForm.appendChild(questionElement);
  });

  // Agregar imagen estática
  const adImage = document.createElement("img");
  adImage.src = staticImage;
  adImage.alt = "Imagen publicitaria";
  quizForm.appendChild(adImage);
}

function gradeQuiz() {
  let overallScore = 0;
  let resultsHTML = "<h2>Resultados</h2>";

  const randomImageQuestion = imageQuestionBank.find(
    (imgQ) => imgQ.image === quizImage.src
  );

  randomImageQuestion.questions.forEach((q, index) => {
    const selectedOption = quizForm[`image-question-${index}`].value;
    if (selectedOption === "" || selectedOption === undefined) {
      resultsHTML += `<p>${index + 1}. ${q.question} - <span class="wrong-answer">Sin responder</span>. Respuesta correcta: <span class="correct-answer">${q.options[q.answer]}</span></p>`;
    } else if (parseInt(selectedOption) === q.answer) {
      overallScore++;
      resultsHTML += `<p>${index + 1}. ${q.question} - <span class="correct-answer">Correcto</span></p>`;
    } else {
      resultsHTML += `<p>${index + 1}. ${q.question} - <span class="wrong-answer">Incorrecto</span>. Respuesta correcta: <span class="correct-answer">${q.options[q.answer]}</span></p>`;
    }
  });

  resultsHTML += `<p>Puntuación total: ${overallScore}/${randomImageQuestion.questions.length}</p>`;
  resultsDiv.innerHTML = resultsHTML;

  submitButton.style.display = "none";
  restartButton.style.display = "inline";
}

submitButton.addEventListener("click", (e) => {
  e.preventDefault();
  gradeQuiz();
});

restartButton.addEventListener("click", loadQuiz);

loadQuiz();
  </script>
</body>
</html>
